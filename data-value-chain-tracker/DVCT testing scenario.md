# DVCT Testing Scenario

**Scenario 1: One Data Provider and One AI/Service Provider Scenario Overview:**

 - Data Provider: An educational institution providing historical
   training data, including course completion rates, exam results, and
   student feedback.
   
   AI/Service Provider: A company that uses the data to develop a
   personalized learning algorithm to enhance the training program.

**Incentive Distribution:**

 - Data Provider: 60 points (60% of the total points). Rationale: The
   educational institution's data is critical for developing the
   personalized learning algorithm. Since they are the sole provider of
   the data, they receive the majority share.
   
   AI/Service Provider: 40 points (40% of the total points). Rationale:
   The AI/service provider’s role in developing the personalized
   algorithm is crucial, but since they rely on the provided data, they
   receive a smaller share than the data provider.

| Story/Activity Flow                                                                     | Description                                                                                                                                                                                            | API to Call                               | Input (Data/JSON)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Output (Data/JSON)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| --------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Step 1: Data Provider Installs DVCT                                                     | The Data Provider (educational institution) installs the DVCT building block to monitor and trace the usage of their data when shared across different platforms.                                      | No API yet (installation step)            | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Step 2: Data Provider Shares Data with AI/Service Provider through Data Space Connector | The Data Provider shares the training data with the AI/Service Provider using a Data Space Connector. The data is only consumed after passing through this connector, ensuring traceability.           | N/A (Connector Setup)                     | Data shared between the Data Provider and AI/Service Provider using the connector                                                                                                                                                                                                                                                                                                                                                                                                                     | N/A (Data Space Connector handles data transfer)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Step 3: AI/Service Provider Consumes the Data                                           | The AI/Service Provider retrieves the data from the Data Space Connector and uses it to develop their personalized learning algorithm. The data usage triggers the DVCT API.                           | N/A (Data consumed via Connector)         | Data consumed by AI/Service Provider through the Data Space Connector                                                                                                                                                                                                                                                                                                                                                                                                                                 | N/A (Triggers DVCT API after data consumption)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Step 4: DVCT API Triggers After Data Consumption                                        | After the data is consumed on the Data Space Connector by the AI/Service Provider, the DVCT is triggered, enabling tracking of data usage with metadata sent for monitoring and incentive calculation. | POST /api/node                            | { "dvctId": "connector_id", "usecaseContractId": "use_case_contract_id", "usecaseContractTitle": "use_case_contract_title", "extraIncentiveForAIProvider": { "numPoints": 10, "factor": 1, "factorCheck": false }, "contractId": "contract_id", "dataId": "data_id", "dataProviderId": "data_provider_id", "dataConsumerId": "data_consumer_id", "dataConsumerIsAIProvider": false, "prevDataId": "prev_data_id", "incentiveForDataProvider": { "numPoints": 5, "factor": 1, "factorCheck": false } } | { "message": "Data usage recorded", "data": { "nodeId": "12345", "provider": "Educational Institution", "metadata": {...} } }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Step 5: Data Provider Receives Confirmation of Data Consumption                         | The DVCT consumer records the usage of the Data Provider’s data with the provided metadata, allowing them to track where and how their data has been used.                                             | Response from POST /api/node              | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | { "message": "Data consumption recorded successfully", "data": { "nodeId": "12345", "metadata": {...} } }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Step 6: Incentive Distribution Based on the Data Usage Contract                         | The DVCT calculates and distributes the incentives based on the pre-defined contract: 60 points for the Data Provider and 40 points for the AI/Service Provider.                                       | POST /api/incentives/distribute           | { "distribution": [ { "provider": "Educational Institution", "points": 60 }, { "provider": "AI/Service Provider", "points": 40 } ], "contractId": "56789" }                                                                                                                                                                                                                                                                                                                                           | { "message": "Incentives distributed successfully", "distribution": { "Educational Institution": 60, "AI/Service Provider": 40 } }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Step 6.1: Error Prevention: Validation of Points Distribution                           | The DVCT validates the points distribution to ensure that it matches the 60:40 split and that the total equals 100 points. If there is a mismatch, an error message is returned.                       | POST /api/incentives/distribute           | Same input as Step 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | { "error": "Distribution mismatch", "details": "Sum of points does not equal 100 or invalid distribution percentages" }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Step 6.2: Error Prevention: Ensuring Contract Validity                                  | Before distributing incentives, the DVCT checks that the contractId is valid and active. If the contract is invalid or expired, an error is returned to both parties.                                  | POST /api/incentives/distribute           | Invalid or non-existing contractId                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | { "error": "Invalid contract", "details": "Contract not found or expired" }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Step 7: Data Provider Requests History of Data Usage (NodeTree)                         | The Data Provider requests a NodeTree, starting from a specific nodeId, to retrieve the node and all its connected child and grandchild nodes, showing the hierarchical relationship.                  | GET /api/node-tree/{nodeId}               | nodeId as a path parameter (e.g., /api/node-tree/12345)                                                                                                                                                                                                                                                                                                                                                                                                                                               | { "nodeId": "root_node_id", "dataId": "root_data_id", "nodeMetadata": { "dvctId": "connector_id", "usecaseContractId": "contract_id", "dataProviderId": "provider_id", "dataConsumerId": "consumer_id", "incentiveReceivedFrom": [ { "organizationId": "org_id_1", "numPoints": 5, "contractId": "contract_1" }, { "organizationId": "org_id_2", "numPoints": 10, "contractId": "contract_2" } ] }, "totalIncentive": 35, "childNode": [ { "nodeId": "child_node_1", "dataId": "child_data_1", "nodeMetadata": { "dvctId": "child_connector_1", "usecaseContractId": "child_contract_1", "dataProviderId": "child_provider_1", "dataConsumerId": "child_consumer_1" }, "totalIncentive": 20, "childNode": [] } ] } |
| Step 8: AI/Service Provider Requests the Submitted Data (If Needed)                     | If required, the AI/Service Provider can request metadata again using the nodeId to further enhance their algorithm or to track data usage.                                                            | GET /api/data/{nodeId}                    | nodeId (e.g., 12345)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | { "data": { "dvctId": "connector_id", "usecaseContractId": "use_case_contract_id", "metadata": {...} } }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Step 8.1: Error Handling for Invalid Data Request                                       | If the AI/Service Provider requests the metadata using an invalid nodeId, the API returns an error message, notifying them that the data could not be found.                                           | GET /api/data/{nodeId}                    | Invalid nodeId (e.g., non-existing or incorrect format)                                                                                                                                                                                                                                                                                                                                                                                                                                               | { "error": "Data not found", "details": "Invalid nodeId or metadata does not exist" }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Step 9: Data Provider and AI/Service Provider Validate Incentive Distribution           | The Data Provider and AI/Service Provider can verify that the incentive distribution matches the contract terms. The DVCT API validates the distribution and provides a detailed response.             | GET /api/incentives/validate/{contractId} | Valid contractId (e.g., 56789)                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | { "message": "Validation successful", "distribution": { "Educational Institution": 60, "AI/Service Provider": 40 } }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Step 9.1: Error Handling for Mismatched Points Distribution                             | If the points assigned to either party do not match the contract (60:40), the system identifies the mismatch and reports the error to both parties.                                                    | GET /api/incentives/validate/{contractId} | Incorrectly assigned points or tampering detected                                                                                                                                                                                                                                                                                                                                                                                                                                                     | { "error": "Invalid incentive distribution", "details": "Mismatch in assigned points with contract terms" }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
